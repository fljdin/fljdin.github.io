<!doctype html><html lang=fr><head><title>Le fenêtrage à la rescousse</title><link rel=stylesheet href=https://fljd.in/css/main.min.css><link rel=apple-touch-icon sizes=180x180 href=/ico/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/ico/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/ico/favicon-16x16.png><link rel=manifest href=/ico/site.webmanifest><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8></head><body><div class="container content"><header class=homepage><h3 class=homepage-title><a href=/ title="Florent Jardin">Florent Jardin</a>
<small><a href=/index.xml><svg class="svg-icon"><use xlink:href="https://fljd.in/img/social-icons.svg#rss"/></svg></a><a href=https://twitter.com/fljdin><svg class="svg-icon"><use xlink:href="https://fljd.in/img/social-icons.svg#twitter"/></svg></a><a href=https://github.com/fljdin><svg class="svg-icon"><use xlink:href="https://fljd.in/img/social-icons.svg#github"/></svg></a><a href=https://www.linkedin.com/in/florent-jardin><svg class="svg-icon"><use xlink:href="https://fljd.in/img/social-icons.svg#linkedin"/></svg></a>&nbsp;&nbsp;<a href=/conferences>Conférences</a>&nbsp;&nbsp;<a href=/archives>Archives</a>&nbsp;&nbsp;<a href=/a-propos>À propos</a></small></h3></header><main><article class=post><h1 class=post-title>Le fenêtrage à la rescousse</a></h1><p class=post-date><time datetime=2023-02-10>10 févr 2023</time>
- 5 minutes de lecture</p><p>PostgreSQL propose un certain nombre de fonctions qui permettent de calculer des
valeurs agrégées ou relatives sur un ensemble de lignes qui se situent dans une
« fenêtre » autours de la ligne courante. En utilisant de telles fonctions,
n&rsquo;importe qui peut créer des requêtes plus avancées et plus efficaces pour
l&rsquo;analyse de leur base de données.</p><p>Depuis plusieurs semaines, je contribue à un projet de conversion de modèles de
données vers PostgreSQL, appelé <a href=https://github.com/cybertec-postgresql/db_migrator target=_blank rel=noopener>db_migrator</a>. À cette occasion, j&rsquo;ai
(re)découvert la puissance de ces <a href=https://www.postgresql.org/docs/current/functions-window.html target=_blank rel=noopener>fonctions de fenêtrage</a> avec le langage
SQL. Dans cet article, je reviens sur un <a href=https://github.com/cybertec-postgresql/db_migrator/pull/11 target=_blank rel=noopener>cas concret</a> de transformation des
bornes supérieures d&rsquo;une table partitionnée en tableau de valeur.</p><hr><h2 id=à-travers-une-fenêtre>À travers une fenêtre</h2><p>On ne va pas se le cacher, l&rsquo;utilisation d&rsquo;une fenêtre dans une requête n&rsquo;est
(vraiment) pas fréquente. Le fenêtrage est particulièrement utile pour effectuer
des analyses de données en décalage temporel, telles que les totaux cumulatifs,
les moyennes mobiles, les tendances, etc.</p><p>Les fonctions de fenêtrage les plus couramment utilisées dans PostgreSQL
sont <code>first_value()</code>, <code>last_value()</code>, <code>rank()</code>, <code>row_number()</code> et <code>lag()</code>.
Ces fonctions peuvent être combinées avec des fonctions d&rsquo;agrégation telles que
<code>sum()</code>, <code>avg()</code>, <code>count()</code>, <code>min()</code> et <code>max()</code> pour produire des résultats
encore plus utiles.</p><p>Prenons l&rsquo;exemple de la méthode <code>first_value()</code> qui permet d&rsquo;identifier la
première ligne de la fenêtre rattachée à chaque ligne. Avec le cas concret du
partitionnement, on souhaite connaître la première partition définie pour la
table pour chaque ligne d&rsquo;une table nommée <code>partitions</code> :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>table_name</span><span class=p>,</span><span class=w> </span><span class=n>partition_name</span><span class=p>,</span><span class=w> </span><span class=n>upper_bound</span><span class=p>,</span><span class=w> </span><span class=k>position</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>first_value</span><span class=p>(</span><span class=n>partition_name</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>table_name</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>position</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>first_partition</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>partitions</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl> table_name | partition_name | upper_bound | position | first_partition 
</span></span><span class=line><span class=cl>------------+----------------+-------------+----------+-----------------
</span></span><span class=line><span class=cl> tab        | less_than_10   | 10          |        1 | less_than_10
</span></span><span class=line><span class=cl> tab        | less_than_20   | 20          |        2 | less_than_10
</span></span><span class=line><span class=cl> tab        | less_than_30   | 30          |        3 | less_than_10
</span></span><span class=line><span class=cl> tab        | less_than_40   | 40          |        4 | less_than_10
</span></span><span class=line><span class=cl> tab        | less_than_max  | MAXVALUE    |        5 | less_than_10
</span></span></code></pre></div><p>Une fonction de fenêtrage est employée en conjonction avec la clause <code>OVER</code> pour
spécifier les limites de la fenêtre, en déterminant la colonne commune aux
lignes sur lesquelles la fonction de fenêtrage s&rsquo;applique. Ici, la fenêtre
regroupe les données de partitionnement selon le nom de la table (<code>table_name</code>)
en les triant avec la clause <code>ORDER BY</code>.</p><p>Une fenêtre se déplace pour chaque ligne, en élargissant ses bornes en fonction
des nouvelles lignes qu&rsquo;elle parcourt dans l&rsquo;ordre de tri des données. Si on
souhaite récupérer la dernière partition définie pour la table de chaque ligne,
il est nécessaire d&rsquo;<strong>inverser le tri</strong> de la fenêtre, afin de démarrer la
lecture par le bas jusqu&rsquo;à la ligne courante et de <strong>trier à nouveau</strong> le
résultat.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>table_name</span><span class=p>,</span><span class=w> </span><span class=n>partition_name</span><span class=p>,</span><span class=w> </span><span class=n>upper_bound</span><span class=p>,</span><span class=w> </span><span class=k>position</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>first_value</span><span class=p>(</span><span class=n>partition_name</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>table_name</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>position</span><span class=w> </span><span class=k>DESC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>last_partition</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>partitions</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>position</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl> table_name | partition_name | upper_bound | position | last_partition 
</span></span><span class=line><span class=cl>------------+----------------+-------------+----------+----------------
</span></span><span class=line><span class=cl> tab        | less_than_10   | 10          |        1 | less_than_max
</span></span><span class=line><span class=cl> tab        | less_than_20   | 20          |        2 | less_than_max
</span></span><span class=line><span class=cl> tab        | less_than_30   | 30          |        3 | less_than_max
</span></span><span class=line><span class=cl> tab        | less_than_40   | 40          |        4 | less_than_max
</span></span><span class=line><span class=cl> tab        | less_than_max  | MAXVALUE    |        5 | less_than_max
</span></span></code></pre></div><hr><h2 id=déterminer-la-borne-inférieure>Déterminer la borne inférieure</h2><p>Avec Oracle ou même MySQL, le partitionnent par intervalles ne prend en compte
que la borne supérieure pour répartir les données dans les partitions. Ainsi, la
création d&rsquo;une table partitionnée est semblable à l&rsquo;exemple suivant :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>tab</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>junk</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>RANGE</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PARTITION</span><span class=w> </span><span class=n>less_than_10</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>LESS</span><span class=w> </span><span class=k>THAN</span><span class=w> </span><span class=p>(</span><span class=mi>10</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PARTITION</span><span class=w> </span><span class=n>less_than_20</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>LESS</span><span class=w> </span><span class=k>THAN</span><span class=w> </span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PARTITION</span><span class=w> </span><span class=n>less_than_30</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>LESS</span><span class=w> </span><span class=k>THAN</span><span class=w> </span><span class=p>(</span><span class=mi>30</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PARTITION</span><span class=w> </span><span class=n>less_than_40</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>LESS</span><span class=w> </span><span class=k>THAN</span><span class=w> </span><span class=p>(</span><span class=mi>40</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PARTITION</span><span class=w> </span><span class=n>less_than_max</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>LESS</span><span class=w> </span><span class=k>THAN</span><span class=w> </span><span class=k>MAXVALUE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>PostgreSQL est plus strict sur la définition des partitions de type <code>RANGE</code> avec
l&rsquo;utilisation des bornes inférieures et supérieures, comme ceci :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>tab</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>junk</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>RANGE</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>less_than_10</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PARTITION</span><span class=w> </span><span class=k>OF</span><span class=w> </span><span class=n>tab</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=k>MINVALUE</span><span class=p>)</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=p>(</span><span class=mi>10</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>less_than_20</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PARTITION</span><span class=w> </span><span class=k>OF</span><span class=w> </span><span class=n>tab</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=mi>10</span><span class=p>)</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=p>(</span><span class=mi>20</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>less_than_30</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PARTITION</span><span class=w> </span><span class=k>OF</span><span class=w> </span><span class=n>tab</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=p>(</span><span class=mi>30</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>less_than_40</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PARTITION</span><span class=w> </span><span class=k>OF</span><span class=w> </span><span class=n>tab</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=mi>30</span><span class=p>)</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=p>(</span><span class=mi>40</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>less_than_max</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PARTITION</span><span class=w> </span><span class=k>OF</span><span class=w> </span><span class=n>tab</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=mi>40</span><span class=p>)</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=p>(</span><span class=k>MAXVALUE</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>Avec le jeu de données précédent, il devient nécessaire de faire le
rapprochement entre une partition et celle qui la précède pour reconstruire les
bornes inférieure et supérieure. La fonction de fenêtrage <code>lag()</code> permet
justement d&rsquo;extraire la donnée d&rsquo;une autre ligne placée au-dessous d&rsquo;elle dans
la fenêtre courante.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>lag (value anycompatible [, offset integer [, default anycompatible ]]) 
</span></span><span class=line><span class=cl>   → anycompatible
</span></span></code></pre></div><blockquote><p>Renvoie <code>value</code> évaluée à la ligne qui se trouve à <code>offset</code> lignes avant la
ligne actuelle dans la fenêtre ; si une telle ligne n&rsquo;existe pas, renvoie
<code>default</code> à la place.</p></blockquote><p>La requête suivante répond à ce problème :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>table_name</span><span class=p>,</span><span class=w> </span><span class=n>partition_name</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=nb>ARRAY</span><span class=p>[</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=n>lag</span><span class=p>(</span><span class=n>upper_bound</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;MINVALUE&#39;</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>               </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>table_name</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>               </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>position</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=n>upper_bound</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=p>]::</span><span class=nb>text</span><span class=p>[]</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>boundaries</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>partitions</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl> table_name | partition_name |  boundaries   
</span></span><span class=line><span class=cl>------------+----------------+---------------
</span></span><span class=line><span class=cl> tab        | less_than_10   | {MINVALUE,10}
</span></span><span class=line><span class=cl> tab        | less_than_20   | {10,20}
</span></span><span class=line><span class=cl> tab        | less_than_30   | {20,30}
</span></span><span class=line><span class=cl> tab        | less_than_40   | {30,40}
</span></span><span class=line><span class=cl> tab        | less_than_max  | {40,MAXVALUE}
</span></span></code></pre></div><p>Une autre requête avec <code>first_value()</code> avait été employée avant que <code>lag()</code>
n&rsquo;ait été proposée par Laurenz Albe dans la forme définitive de mes travaux.
Pour un résultat équivalent, elle a été jugée moins adaptée en s&rsquo;appuyant
inutilement sur des clauses plus poussées telles que <code>RANGE BETWEEN</code> et
<code>EXCLUDE</code>. Je vous laisse apprécier la syntaxe complète.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>table_name</span><span class=p>,</span><span class=w> </span><span class=n>partition_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=nb>ARRAY</span><span class=p>[</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=n>coalesce</span><span class=p>(</span><span class=n>first_value</span><span class=p>(</span><span class=n>upper_bound</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>position</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=n>RANGE</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=n>PRECEDING</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>CURRENT</span><span class=w> </span><span class=k>ROW</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=n>EXCLUDE</span><span class=w> </span><span class=k>CURRENT</span><span class=w> </span><span class=k>ROW</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=p>),</span><span class=w> </span><span class=s1>&#39;MINVALUE&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=n>upper_bound</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=p>]::</span><span class=nb>text</span><span class=p>[]</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>boundaries</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>partitions</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><hr><h2 id=conclusion>Conclusion</h2><p>Le fenêtrage n&rsquo;est pas évident à se représenter mentalement, d&rsquo;autant plus que
les cas concrets et pertinents ne se rencontrent pas fréquemment. Sans pour
autant en maîtriser les subtilités, il est utile d&rsquo;en connaître la finalité, ou
tout du moins l&rsquo;existence. Il aurait été tentant de faire des jointures, des CTE
ou des sous-requêtes mais en payant le prix fort d&rsquo;une lisibilité amoindrie et
de potentielles barrières à l&rsquo;optimisation.</p></article><aside class=related><h3>Suggestion d'articles</h3><ul class=related-posts><li><a href=https://fljd.in/2022/06/29/dessine-moi-un-arbre-abstrait/>Dessine-moi un arbre (abstrait)
<small><time datetime=2022-06-29>29 juin 2022</time></small></a></li><li><a href=https://fljd.in/2022/04/21/halte-aux-regressions/>Halte aux régressions
<small><time datetime=2022-04-21>21 avr 2022</time></small></a></li><li><a href=https://fljd.in/2022/03/11/conversions-implicites/>Conversions implicites
<small><time datetime=2022-03-11>11 mars 2022</time></small></a></li></ul></aside></main><footer class=footer><small>&copy; 2019-<time datetime=2023-02-10>2023</time>
— <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/deed.fr>Creative Commons License BY-NC-ND 4.0</a></small></footer></div></body></html>